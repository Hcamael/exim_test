<dec f='exim/src/functions.h' l='301' type='BOOL moan_to_sender(int , error_block * , header_line * , FILE * , BOOL )'/>
<def f='exim/src/moan.c' l='373' ll='456' type='BOOL moan_to_sender(int ident, error_block * eblock, header_line * headers, FILE * message_file, BOOL check_sender)'/>
<doc f='exim/src/moan.c' l='350'>/* This function is called when errors are detected during the receipt of a
message. Delivery failures are handled separately in deliver.c.

If there is a valid sender_address, and the failing message is not a local
error message, then this function calls moan_send_message to send a message to
that person. If the sender&apos;s address is null, then an error has occurred with a
message that was generated by a mailer daemon. All we can do is to write
information to log files. The same action is taken if local_error_message is
set - this can happen for non null-senders in certain configurations where exim
doesn&apos;t run setuid root.

Arguments:
  ident         identifies the particular error
  eblock        chain of error_blocks containing data about the error
  headers       message&apos;s headers (chain)
  message_file  a FILE where the body of the message can be read
  check_sender  if TRUE, read the first line of the file for a possible
                  &quot;From &quot; sender (if a trusted caller)

Returns:        FALSE if there is no sender_address to send to;
                else the return from moan_send_message()
*/</doc>
<use f='exim/src/exim.c' l='5471' u='c' c='main'/>
<use f='exim/src/exim.c' l='5510' u='c' c='main'/>
<use f='exim/src/receive.c' l='1141' u='c' c='give_local_error'/>
<use f='exim/src/receive.c' l='3254' u='c' c='receive_msg'/>
